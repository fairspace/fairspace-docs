<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<meta name="description" content="Fairspace documentation.">
<title>Fairspace</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sa {
  color: #000000;
  font-weight: bold;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of contents</div>
<ul class="sectlevel1">
<li><a href="#_usage">Usage</a>
<ul class="sectlevel2">
<li><a href="#_user_interface">User interface</a>
<ul class="sectlevel3">
<li><a href="#_login">Login</a></li>
<li><a href="#_workspaces">Workspaces</a></li>
<li><a href="#_collections">Collections</a></li>
<li><a href="#_metadata">Metadata</a></li>
</ul>
</li>
<li><a href="#_interfaces_for_accessing_and_querying_data_api">Interfaces for accessing and querying data (API)</a>
<ul class="sectlevel3">
<li><a href="#_authentication">Authentication</a></li>
<li><a href="#_webdav">WebDAV</a></li>
<li><a href="#_sparql">SPARQL</a></li>
<li><a href="#_rdf_metadata">RDF metadata</a></li>
<li><a href="#_metadata_views">Metadata views</a></li>
<li><a href="#_configuration_endpoints">Configuration endpoints</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_structure_and_terminology">Structure and terminology</a>
<ul class="sectlevel2">
<li><a href="#_workflow_and_access_modes">Workflow and access modes</a></li>
<li><a href="#_roles_and_permissions">Roles and permissions</a></li>
</ul>
</li>
<li><a href="#_data_model_and_view_configuration">Data model and view configuration</a>
<ul class="sectlevel2">
<li><a href="#_limitations">Limitations</a></li>
<li><a href="#_controlled_vocabularies">Controlled vocabularies</a></li>
</ul>
</li>
<li><a href="#_installation_and_configuration">Installation and configuration</a>
<ul class="sectlevel2">
<li><a href="#_local_development">Local development</a></li>
<li><a href="#_kubernetes_and_helm">Kubernetes and helm</a>
<ul class="sectlevel3">
<li><a href="#_instructions_for_deploying_to_google_cloud">Instructions for deploying to Google Cloud</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_design">Design</a>
<ul class="sectlevel2">
<li><a href="#_storage">Storage</a></li>
</ul>
</li>
<li><a href="#_license">License</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><img src="docs/images/Fairspace.png" alt="Fairspace"></span></p>
</div>
<div class="paragraph">
<p>Fairspace is a secure place for managing research data.
Research teams have their own workspaces in which they
can manage research data collections.
Researchers can upload directories and files to data collections.
Data access is organised on data collection level.
Collections can be shared with other teams or individual researchers.
Also, collections can be published for all researchers in the organisation.<br></p>
</div>
<div class="paragraph">
<p>Collections and files can be annotated with descriptive metadata.
The metadata is stored using the <a href="https://en.wikipedia.org/wiki/Resource_Description_Framework">Resource Description Framework (RDF)</a> in
an <a href="https://jena.apache.org/">Apache Jena</a> database.
For the metadata, a data model can be configured that suits
the data management needs of the organisation.
The data model is specified using the <a href="https://www.w3.org/TR/shacl/">Shapes Constraint Language (SHACL)</a>,
see the section on <a href="#_data_model_and_view_configuration">Data model and view configuration</a>.
Descriptive metadata entities (e.g., subjects, projects, samples) should be added to the database by a
careful process, ensuring that duplicates and inconsistencies are avoided and
all entities have proper unique identifiers.
The application provides overviews of the available metadata entities.
In the collection browser, researchers can link their collections and file to these entities
or add textual descriptions and key words.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title"><strong>Key features</strong></div>
<div class="ulist">
<ul>
<li>
<p>Fairspace is a data repository that enables researchers to securely <strong>store</strong> and <strong>organise</strong> their research data sets,
and <strong>share</strong> the data with collaborators.</p>
</li>
<li>
<p>Fairspace lets researchers annotate their data collections with relevant metadata properties
and link the data to associated metadata entities (subjects, samples, projects, etc.).
This helps researchers find their own data and make it <strong>findable</strong> for others,
contributing to implementation of the <a href="https://www.go-fair.org/fair-principles/">FAIR principles</a>.</p>
</li>
<li>
<p>Fairspace ensures that all metadata entities have a unique identifier and validates
metadata consistency and validity upon data entry.</p>
</li>
<li>
<p>Fairspace allows organisations to use <strong>customise</strong> the configured data model,
by specifying custom entity types and constraints.
This enables the adoption of community standards for metadata relevant for the research domain,
which contributes to the <strong>reusability</strong> of the data.</p>
</li>
<li>
<p>Fairspace uses the <a href="https://en.wikipedia.org/wiki/Resource_Description_Framework">Resource Description Framework (RDF)</a> and <a href="https://en.wikipedia.org/wiki/WebDAV">WebDAV</a> standards for data exchange,
and stimulates the uses of standard vocabularies,
contributing to <strong>interoperability</strong> of data.</p>
</li>
</ul>
</div>
</div>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect1">
<h2 id="_usage">Usage</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_user_interface">User interface</h3>
<div class="sect3">
<h4 id="_login">Login</h4>
<div class="paragraph">
<p>Users are authenticated using <a href="https://www.keycloak.org/">Keycloak</a>, an open-source identity provider
that provides secure authentication methods and can be configured to integrate
with institutional identity providers using user federation or identity brokering,
see the <a href="https://www.keycloak.org/docs/latest/server_admin/">Keycloak server administration</a> pages.</p>
</div>
<div class="paragraph">
<p>The user either logs in directly using Keycloak or is forwarded to a configured
external login:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="docs/images/screenshots/Keycloak%20login.png" alt="Keycloak login"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_workspaces">Workspaces</h4>
<div class="paragraph">
<p>Users enter Fairspace on the workspaces page that lists all workspaces.
A workspace represents a team in the organisation that collaborates on research data collections.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="docs/images/screenshots/Workspace%20list.png" alt="Workspace list"></span></p>
</div>
<div class="paragraph">
<p>Workspace administrators can edit the workspace overview page and
manage workspace membership. All workspace members can add collections to the workspace.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="docs/images/screenshots/Workspace%20overview.png" alt="Workspace overview"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_collections">Collections</h4>
<div class="paragraph">
<p>The contents of collections can be navigated in the collections browser.
It behaves like a regular file browser. Click to select a directory or file
and see its metadata, double click to navigate into directories or
open a file.</p>
</div>
<div class="paragraph">
<p>Access is managed on collection level.
Users with at least write access to a collection can upload files or directories,
rename or delete files, restore old file versions,
and edit the associated metadata.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="docs/images/screenshots/Collection%20browser.png" alt="Collection browser"></span></p>
</div>
<div class="sect4">
<h5 id="_metadata_forms">Metadata forms</h5>
<div class="paragraph">
<p>Users with write access to the collection can annotate collections,
directories and files using <em>metadata forms</em>.
Free text fields, like description and key words, can be entered freely,
links to shared entities, like subjects, samples and projects, or
values from a controlled vocabulary, like taxonomy or analysis type,
can be selected from a list:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="docs/images/screenshots/Metadata%20form.png" alt="Metadata form"></span></p>
</div>
<div class="paragraph">
<p>The shared metadata entities and controlled vocabularies cannot
be added via the user interface.
The <a href="#Metadata upload API">[Metadata upload API]</a> should be used for that instead.</p>
</div>
</div>
<div class="sect4">
<h5 id="_metadata_upload">Metadata upload</h5>
<div class="paragraph">
<p>Another way to annotate directories and files is by uploading a comma-separated values (CSV) file with metadata.
This section describes the CSV-based format used for bulk metadata uploads.</p>
</div>
<div class="paragraph">
<p>The file should be a valid CSV-file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Records are separated with a <code>,</code>-character.</p>
</li>
<li>
<p>Values may be enclosed in double quotes: <code>"value"</code>.</p>
</li>
<li>
<p>In values that contain a double, the double quotes need to be escaped by replacing them with double double quotes:
<code>Example "quoted" text</code> becomes <code>"Example ""quoted"" text"</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the metadata upload, lines starting with <code>#</code> are ignored. These lines are considered to be comments.</p>
</div>
<div class="paragraph">
<p>The file should have a header row containing the names of the columns.
The mandatory <code>Path</code> column is used for the file path. For the property columns, the name should match exactly the name of the property in the database.</p>
</div>
<div class="paragraph">
<p>The format of the values is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Path</em>: the relative path to a file or a directory (relative to the collection or directory where the file is uploaded).
Use <code>./</code> for the current directory or collection.</p>
</li>
<li>
<p><em>Entity types</em> can be referenced by ID or unique label.</p>
</li>
<li>
<p>Multiple values must be separated by the pipe symbol <code>|</code>, e.g.,
use <code>test|lab</code> to enter the values <code>test</code> and <code>lab</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The file can be uploaded to the current directory by dropping the file in the metadata panel of the directory, or by selecting the metadata upload button.<br>
By hovering over the metadata upload button, a link to a <em>metadata template file</em> becomes available:</p>
</div>
<div class="paragraph">
<p><span class="image th"><img src="docs/images/screenshots/Download%20metadata%20template.png" alt="Download metadata template"></span></p>
</div>
<div class="paragraph">
<p>The file describes the format in commented lines and
contains the available properties in the header row.</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. Example metadata file</div>
<div class="content">
<div class="paragraph">
<p>An example comma-separated values file with metadata about the current directory <code>./</code>,
which is annotated with a description and two key words (<code>sample</code> and <code>lab</code>),
and the file <code>test.txt</code> which is linked to Subject 1 by the unique subject label
and to the RNA-seq analysis type by the analysis type identifier (<code>O6-12</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csv">Path,Is about subject,Type of analysis,Description,Keywords
./,,,Directory with samples,sample|lab,
test.txt,Subject 1,https://institut-curie.org/analysis#O6-12,,</code></pre>
</div>
</div>
<div class="paragraph">
<p>This specified the table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Path</th>
<th class="tableblock halign-left valign-top">Is about subject</th>
<th class="tableblock halign-left valign-top">Type of analysis</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Keywords</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">./</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory with samples</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sample|lab</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">test.txt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subject 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://institut-curie.org/analysis#O6-12" class="bare">https://institut-curie.org/analysis#O6-12</a></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_metadata">Metadata</h4>
<div class="paragraph">
<p>Explore metadata and find associated collections and files.
<span class="image"><img src="docs/images/screenshots/Metadata%20view.png" alt="Metadata"></span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_interfaces_for_accessing_and_querying_data_api">Interfaces for accessing and querying data (API)</h3>
<div class="sect3">
<h4 id="_authentication">Authentication</h4>
<div class="sect4">
<h5 id="_openid_connect_oicd_oauth2_workflow">OpenID Connect (OICD) / OAuth2 workflow</h5>
<div class="paragraph">
<p>Via header, via session.</p>
</div>
<details>
<summary class="title">Fetch token (Python code example)</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">fetch_access_token</span><span class="p">(</span><span class="n">keycloak_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                       <span class="n">realm</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                       <span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                       <span class="n">client_secret</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                       <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                       <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="s">"""
    Obtain access token from Keycloak
    :return: the access token as string.
    """</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'client_id'</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
        <span class="s">'client_secret'</span><span class="p">:</span> <span class="n">client_secret</span><span class="p">,</span>
        <span class="s">'username'</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span>
        <span class="s">'password'</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
        <span class="s">'grant_type'</span><span class="p">:</span> <span class="s">'password'</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-type'</span><span class="p">:</span> <span class="s">'application/x-www-form-urlencoded'</span><span class="p">,</span>
        <span class="s">'Accept'</span><span class="p">:</span> <span class="s">'application/json'</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">keycloak_url</span><span class="si">}</span><span class="s">/auth/realms/</span><span class="si">{</span><span class="n">realm</span><span class="si">}</span><span class="s">/protocol/openid-connect/token'</span><span class="p">,</span>
                             <span class="n">data</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
                             <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">.</span><span class="n">ok</span><span class="p">:</span>
        <span class="n">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="s">'Error fetching token!'</span><span class="p">,</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">'access_token'</span><span class="p">]</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"Token obtained successfully. It will expire in </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s">'expires_in'</span><span class="p">]</span><span class="si">}</span><span class="s"> seconds"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">token</span></code></pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect4">
<h5 id="_basic_authentication">Basic authentication</h5>
<div class="paragraph">
<p>Use the <code>base64</code> encoded <code>username:password</code> in the <code>Authorization</code> header.</p>
</div>
<details>
<summary class="title">Authentication (Curl code example)</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-v</span> <span class="nt">-H</span> <span class="s2">"Authorization: Basic </span><span class="si">$(</span><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"</span><span class="k">${</span><span class="nv">USERNAME</span><span class="k">}</span><span class="s2">:</span><span class="k">${</span><span class="nv">PASSWORD</span><span class="k">}</span><span class="s2">"</span> | <span class="nb">base64</span><span class="si">)</span><span class="s2">"</span> http://localhost:8080/api/users/current</code></pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect4">
<h5 id="_automatic_authentication_in_jupyter_hub">Automatic authentication in Jupyter Hub</h5>
<div class="paragraph">
<p>In Jupyter Hub, users are automatically authenticated and can directly connect to the
local API address without adding authentication headers.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_webdav">WebDAV</h4>
<div class="paragraph">
<p>A file storage API is exposed via the WebDAV protocol. It runs on <code>/api/webdav/</code>. All visible collections in the system are exposed as top-level directories.
Creating a top-level directory via WebDAV will result in an error message.</p>
</div>
<div class="paragraph">
<p>The <a href="https://en.wikipedia.org/wiki/WebDAV">Web-based Distributed Authoring and Versioning (WebDAV)</a> protocol allows users to operate on collections and files.
Fairspace exposes a WebDAV API for accessing the file systems, while restricting access to only the files accessible by the user.</p>
</div>
<div class="paragraph">
<p>The WebDAV API allows to upload and download files and to perform standard file operations such as copying or moving,
as well as custom operations, such as collection lifecycle management
and advanced data loss prevention features such as versioning and undeletion.</p>
</div>
<div class="paragraph">
<p>TODO: Detailed list of supported request methods? Sample request?</p>
</div>
</div>
<div class="sect3">
<h4 id="_sparql">SPARQL</h4>
<div class="paragraph">
<p>The <a href="https://www.w3.org/TR/sparql11-query/">SPARQL</a> API is a standard API for querying RDF databases.
This endpoint is read-only and can be used for advanced search, analytics, data extraction, etc.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3"><code>POST /api/rdf/query</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">SPARQL query</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Parameters:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>query</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SPARQL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>aggregate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include aggregates.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example SPARQL query using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-X</span> POST <span class="nt">-H</span> <span class="s1">'Content-Type: application/sparql-query'</span> <span class="nt">-H</span> <span class="s1">'Accept: application/json'</span>
<span class="nt">-d</span> <span class="s1">'{
  "query": "
    PREFIX example: &lt;https://example.com/ontology#&gt;
    PREFIX fs:    &lt;https://fairspace.nl/ontology#&gt;

    SELECT DISTINCT ?sample
    WHERE {
      ?sample a example:BiologicalSample .
      FILTER NOT EXISTS { ?sample fs:dateDeleted ?anyDateDeleted }
    }
    # ORDER BY ?sample
    LIMIT 500",
  "aggregate": True
}'</span>
<span class="s1">'http://localhost:8080/api/rdf/query'</span></code></pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_rdf_metadata">RDF metadata</h4>
<div class="paragraph">
<p>Metadata can be specified using several formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.w3.org/TR/turtle/">turtle</a> (<code>text/turtle</code>)</p>
</li>
<li>
<p><a href="https://raw.githubusercontent.com/json-ld/json-ld.org/master/schemas/jsonld-schema.json">json-ld</a> (<code>application/ld+json</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example metadata file in turtle format: <code>testdata.ttl</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="turtle"><span class="kd">@prefix</span><span class="w"> </span><span class="nn">example:</span><span class="w"> </span><span class="nl">&lt;https://example.com/ontology#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">rdfs:</span><span class="w"> </span><span class="nl">&lt;http://www.w3.org/2000/01/rdf-schema#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">subject:</span><span class="w"> </span><span class="nl">&lt;http://example.com/subjects#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">file:</span><span class="w"> </span><span class="nl">&lt;http://example.com/api/webdav/&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">gender:</span><span class="w"> </span><span class="nl">&lt;http://hl7.org/fhir/administrative-gender#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">ncbitaxon:</span><span class="w"> </span><span class="nl">&lt;https://bioportal.bioontology.org/ontologies/NCBITAXON/&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">dcat:</span><span class="w"> </span><span class="nl">&lt;http://www.w3.org/ns/dcat#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">

</span><span class="nn">subject:</span><span class="n">s1</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">example:</span><span class="n">Subject</span><span class="w"> </span><span class="p">;</span><span class="w">
           </span><span class="nn">rdfs:</span><span class="n">label</span><span class="w"> </span><span class="s">"Subject 1"</span><span class="w"> </span><span class="p">;</span><span class="w">
           </span><span class="nn">example:</span><span class="n">isOfSpecies</span><span class="w"> </span><span class="nn">ncbitaxon:</span><span class="mi">9606</span><span class="w"> </span><span class="p">.</span><span class="w">

</span><span class="nn">file:</span><span class="n">coll1\/coffee</span><span class="p">.</span><span class="n">jpg
</span><span class="w">    </span><span class="nn">dcat:</span><span class="n">keyword</span><span class="w"> </span><span class="s">"fairspace"</span><span class="p">,</span><span class="w"> </span><span class="s">"java"</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">example:</span><span class="n">aboutSubject</span><span class="w"> </span><span class="nn">example:</span><span class="n">s1</span><span class="w"> </span><span class="p">.</span></code></pre>
</div>
</div>
<details>
<summary class="title">Example uploading metadata file using Python.</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">()</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'testdata.ttl'</span><span class="p">)</span> <span class="k">as</span> <span class="n">testdata</span><span class="p">:</span>
    <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="n">session</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">server_url</span><span class="si">}</span><span class="s">/api/metadata/"</span><span class="p">,</span>
                           <span class="n">data</span><span class="o">=</span><span class="n">testdata</span><span class="p">.</span><span class="n">read</span><span class="p">(),</span>
                           <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s">'Content-type'</span><span class="p">:</span> <span class="s">'text/turtle'</span><span class="p">})</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">.</span><span class="n">ok</span><span class="p">:</span>
        <span class="n">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="s">'Error uploading metadata!'</span><span class="p">)</span>
        <span class="n">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">reason</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</details>
<details>
<summary class="title">Example uploading metadata file using curl.</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-H</span> <span class="s2">"Content-type: text/turtle"</span> <span class="nt">--data</span> @testdata.ttl http://localhost:8080/api/metadata</code></pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>The metadata is stored as triples. Its structure should match the vocabulary definition in /vocabulary.
Any updates that do not match the vocabulary definition will return a 400 status with a message indicating what went wrong.</p>
</div>
<div class="paragraph">
<p>Operations with metadata are implemented using a simple CRUD protocol based on standard RDF triples serialization formats.
Currently, supported formats are JSON-LD and Turtle.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3"><code>GET /api/metadata</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Retrieve metadata</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Parameters:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>subject</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The subject to filter on, not required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>predicate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The predicate to filter on, not required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>object</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The object to filter on, not required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>includeObjectProperties</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set, the response will include several properties for the included objects.
  The properties to be included are marked with <code>fs:importantProperty</code> in the vocabulary.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Response:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Returns JsonLD-encoded statements matching the query parameters.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example of retrieving metadata using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-H</span> <span class="s2">"Accept: application/ld+json"</span> <span class="se">\</span>
<span class="s2">"http://localhost:8080/api/metadata?subject?subject=a&amp;predicate=b&amp;object=c&amp;withValueProperties=true"</span></code></pre>
</div>
</div>
</div>
</details>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3"><code>PUT /api/metadata</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Add metadata. Existing metadata is left untouched.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Request body:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Request body following <a href="https://raw.githubusercontent.com/json-ld/json-ld.org/master/schemas/jsonld-schema.json">jsonld-schema</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Response:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Response contains the workspace name and newly assigned IRI.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example of adding metadata using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-X</span> PUT <span class="nt">-H</span> <span class="s1">'Content-Type: application/ld+json'</span> <span class="nt">-d</span> <span class="se">\</span>
<span class="s1">'{
  "@graph" : [ {
    "@id" : "ws:7f0ed5bb-7a96-4715-8727-6b4b7f1facfd",
    "hasData" : "ws:4bcd1780-c9cd-4bdd-0000-1ce966ff9ac3"
   } ],
  "@context" : {
    "hasData" : {
      "@id" : "http://fairspace.ci.fairway.app/vocabulary/hasData",
      "@type" : "@id"
    },
    "ws" : "http://fairspace.ci.fairway.app/iri/"
  }
}'</span> <span class="se">\</span>
<span class="s2">"http://localhost:8080/api/metadata"</span></code></pre>
</div>
</div>
</div>
</details>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3"><code>PATCH /api/metadata</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Update metadata. Existing metadata is overwritten.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Request body:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Request body following <a href="https://raw.githubusercontent.com/json-ld/json-ld.org/master/schemas/jsonld-schema.json">jsonld-schema</a>.
  Any existing metadata for a given subject/predicate combination will be overwritten with the provided values.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Response:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Response contains the workspace name and newly assigned IRI.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example of updating metadata using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-X</span> PATCH <span class="nt">-H</span> <span class="s1">'Content-Type: application/ld+json'</span> <span class="nt">-d</span> <span class="se">\</span>
<span class="s1">'{
  "@graph" : [ {
    "@id" : "ws:7f0ed5bb-7a96-4715-8727-6b4b7f1facfd",
    "hasData" : "ws:4bcd1780-c9cd-4bdd-0000-1ce966ff9ac3"
   } ],
  "@context" : {
    "hasData" : {
      "@id" : "http://fairspace.ci.fairway.app/vocabulary/hasData",
      "@type" : "@id"
    },
    "ws" : "http://fairspace.ci.fairway.app/iri/"
  }
}'</span> <span class="se">\</span>
<span class="s2">"http://localhost:8080/api/metadata"</span></code></pre>
</div>
</div>
</div>
</details>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3"><code>DELETE /api/metadata</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Delete metadata.
If a request body is given in JSON-LD format, the triples specified in the body will be deleted.
Otherwise, the subject specified in the subject parameter will be marked as deleted.
Please note that the subject will still exist in the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Parameters:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>subject</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The subject to filter on.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Request body:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Response:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Response contains the workspace name and newly assigned IRI.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example of deleting metadata using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-X</span> DELETE <span class="nt">-H</span> <span class="s1">'Content-Type: application/ld+json'</span> <span class="nt">-d</span>
<span class="s1">'{
  "@graph" : [ {
    "@id" : "ws:7f0ed5bb-7a96-4715-8727-6b4b7f1facfd",
    "hasData" : "ws:4bcd1780-c9cd-4bdd-0000-1ce966ff9ac3"
   } ],
  "@context" : {
    "hasData" : {
      "@id" : "http://fairspace.ci.fairway.app/vocabulary/hasData",
      "@type" : "@id"
    },
    "ws" : "http://fairspace.ci.fairway.app/iri/"
  }
}'</span>
<span class="s1">'http://localhost:8080/api/metadata'</span></code></pre>
</div>
</div>
</div>
</details>
<div class="sect4">
<h5 id="_workspace_management">Workspace management</h5>
<div class="paragraph">
<p>Operations on workspace entities.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><code>GET /api/workspaces</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">List all available workspaces.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><em>Response</em> contains the following data:</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>iri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique workspace IRI.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique workspace name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>comment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Workspace description in markdown format.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>managers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of  workspace managers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>summary</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Short summary on the workspace - how many collections and how many users it has.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>canCollaborate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If a current user is added to the workspace as a collaborator.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>canManage</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If a current user is a workspace manager.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example of listing available workspaces using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="s2">"http://localhost:8080/api/workspaces"</span></code></pre>
</div>
</div>
</div>
</details>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3"><code>PUT /api/workspaces</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Add a workspace. Available only to administrators.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Parameters:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique workspace name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Response:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Response contains the workspace name and newly assigned IRI.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example of adding a workspace using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-X</span> PUT <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="nt">-d</span> <span class="s1">'{"name": "test workspace"}'</span> <span class="s2">"http://localhost:8080/api/workspaces"</span></code></pre>
</div>
</div>
</div>
</details>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3"><code>PATCH /api/workspaces</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Update a workspace.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Parameters:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>iri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique workspace IRI <em>(required)</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique workspace name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>comment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Markdown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Workspace description in markdown format.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example of updating a workspace using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-X</span> PATCH <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="nt">-d</span> <span class="se">\</span>
<span class="s1">'{
  "iri": "http://fairspace.com/iri/123,
  "name": "new test name",
  "comment": "New description"
}"'</span> <span class="se">\</span>
<span class="s2">"http://localhost:8080/api/workspaces"</span></code></pre>
</div>
</div>
</div>
</details>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3"><code>DELETE /api/workspaces</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Delete a workspace. Available only to administrators.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Parameters:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>workspace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Workspace IRI (URL-encoded).</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example of deleting a workspace using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-X</span> DELETE <span class="s1">'http://localhost:8080/api/workspaces?workspace=http://fairspace.com/iri/123'</span></code></pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect4">
<h5 id="_workspace_users">Workspace users</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3"><code>GET /api/workspaces/users</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">List all workspace users with workspace roles.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Parameters:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>workspace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Workspace IRI (URL-encoded).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Response:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Response contains list of workspace users with their workspace roles.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example of listing workspace users using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-H</span> <span class="s1">'Accept: application/json'</span> <span class="s1">'http://localhost:8080/api/workspaces/users?workspace=http://fairspace.com/iri/123'</span></code></pre>
</div>
</div>
</div>
</details>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3"><code>PATCH /api/workspaces/users</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Update workspace users and their workspace roles.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Parameters:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>workspace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Workspace IRI (URL-encoded).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Response:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Response contains list of workspace users with their updated workspace roles.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example of updating workspace users using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-H</span> <span class="s1">'Accept: application/json'</span> <span class="s1">'http://localhost:8080/api/workspaces/users?workspace=http://fairspace.com/iri/123'</span></code></pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect4">
<h5 id="_user_and_permission_management">User and permission management</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>GET /api/users</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">List all organisation users.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Response:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns list of users with user&#8217;s unique ID, name, email, username and user&#8217;s organisation-level permissions:
  if a user is an administrator, super-administrator or can view public metadata, view public data or add shared metadata.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example listing users using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-X</span> GET <span class="nt">-H</span> <span class="s1">'Accept: application/json'</span> <span class="s1">'http://localhost:8080/api/users'</span></code></pre>
</div>
</div>
</div>
</details>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3"><code>PATCH /api/users</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Update user roles.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Parameters:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Id of the user for which roles will be updated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"role name"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Role name is any of <code>isAdmin</code>, <code>canViewPublicData</code>, <code>canViewPublicMetadata</code> or <code>canAddSharedMetadata</code>.
  The value determines whether the user has the role or not.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example updating user roles using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-X</span> PATCH <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="nt">-d</span> <span class="se">\</span>
<span class="s1">'{
  "id": "xyz-0000",
  "canViewPublicData": false,
  "canViewPublicMetadata": true
}'</span> <span class="se">\</span>
<span class="s2">"http://localhost:8080/api/users"</span></code></pre>
</div>
</div>
</div>
</details>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>GET /api/users/current</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get current user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Response:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns current user&#8217;s unique ID, name, email, username and user&#8217;s organisation-level permissions:
  if the user is an administrator, super-administrator or can view public metadata,
view public data or add shared metadata.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example getting current user using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="s2">"http://localhost:8080/api/users/current"</span></code></pre>
</div>
</div>
</div>
</details>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>POST /api/users/current/logout</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">logout the current user.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example logging out using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-X</span> POST <span class="s2">"http://localhost:8080/api/users/current/logout"</span></code></pre>
</div>
</div>
</div>
</details>
</div>
</div>
<div class="sect3">
<h4 id="_metadata_views">Metadata views</h4>
<div class="paragraph">
<p>Metadata views endpoint used for metadata-based search.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>GET /api/views</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">List all views with available columns per each view.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-H</span> <span class="s1">'Accept: application/json'</span> <span class="s1">'http://localhost:8080/api/views'</span></code></pre>
</div>
</div>
</div>
</details>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3"><code>POST /api/views</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Fetch page of rows of a view matching the request filters.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Parameters:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>view</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the view.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>filters</code></p></td>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">List of filters, based on available facets and their values.
Each filter has to contain a "field" property, matching the name of a facet, and list of values to filter on.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>page</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Requested page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Page size</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example fetching page of view rows using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-X</span> POST <span class="nt">-H</span> Content-Type<span class="s1">': '</span>application/json<span class="s1">' -H '</span>Accept: application/json<span class="s1">' -d \
'</span><span class="o">{</span>
  <span class="s2">"view"</span>:<span class="s2">"Resource"</span>,
  <span class="s2">"filters"</span>:[
    <span class="o">{</span>
      <span class="s2">"field"</span>:<span class="s2">"Resource_type"</span>,
      <span class="s2">"values"</span>:[<span class="s2">"https://fairspace.nl/ontology#Collection"</span><span class="o">]</span>
    <span class="o">}</span>
  <span class="o">]</span>,
  <span class="s2">"page"</span>:1,
  <span class="s2">"size"</span>:100
<span class="o">}</span><span class="s1">' \
'</span>http://localhost:8080/api/views<span class="s1">'</span></code></pre>
</div>
</div>
</div>
</details>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3"><code>POST /api/views/count</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Count rows of a view matching request filters.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><em>Parameters:</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>view</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the view.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>filters</code></p></td>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">List of filters, based on available facets and their values.
Each filter has to contain a "field" property, matching the name of a facet, and list of values to filter on.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example counting view rows using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-X</span> POST <span class="nt">-H</span> <span class="s1">'Content-type application/json'</span> <span class="nt">-H</span> <span class="s1">'Accept: application/json'</span> <span class="nt">-d</span> <span class="se">\</span>
<span class="s1">'{
  "view":"Resource",
  "filters":[
    {
      "field":"Resource_type",
      "values":["https://fairspace.nl/ontology#Collection"]
    }
  ]
}'</span> <span class="se">\</span>
<span class="s1">'http://localhost:8080/api/views/count'</span></code></pre>
</div>
</div>
</div>
</details>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>GET /api/views/facets</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">List all facets with available values per each facet.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example retrieving facets with values using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-H</span> <span class="s1">'Accept: application/json'</span> <span class="s1">'http://localhost:8080/api/views/facets'</span></code></pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_configuration_endpoints">Configuration endpoints</h4>
<div class="sect4">
<h5 id="_vocabulary">Vocabulary</h5>
<div class="paragraph">
<p>The vocabulary contains a description of the structure of the metadata.
It contains the types of entities that can be created, along with the data types for the fields.
It is stored in <a href="https://www.w3.org/TR/shacl/">SHACL</a> format.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>GET /api/vocabulary</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve a representation of the vocabulary.</p></td>
</tr>
</tbody>
</table>
<details>
<summary class="title">Example fetching the vocabulary in turtle format using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-H</span> <span class="s1">'Accept: text/turtle'</span> <span class="s1">'http://localhost:8080/api/vocabulary'</span></code></pre>
</div>
</div>
</div>
</details>
<details>
<summary class="title">Example fetching the vocabulary in json-ld format using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-H</span> <span class="s1">'Accept: application/json+ld'</span> <span class="s1">'http://localhost:8080/api/vocabulary'</span></code></pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect4">
<h5 id="_features">Features</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>GET /api/features</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">List available application features.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Response contains list of additional features that are currently available in the application,
e.g., metadata editing in the user interface.</p>
</div>
<details>
<summary class="title">Example listing features using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-X</span> GET <span class="nt">-H</span> <span class="s1">'Accept: application/json'</span> <span class="s1">'http://localhost:8080/api/features'</span></code></pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect4">
<h5 id="_services">Services</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>GET /api/services</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">List linked services.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Response contains list of external services linked to Fairspace,
e.g. JupyterHub, cBioPortal, etc.</p>
</div>
<details>
<summary class="title">Example listing services using curl</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl <span class="nt">-H</span> <span class="s1">'Accept: application/json'</span> <span class="s1">'http://localhost:8080/api/services'</span></code></pre>
</div>
</div>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_structure_and_terminology">Structure and terminology</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section we describe in detail the main concepts and components of the
Fairspace data repository and how they relate to each other.</p>
</div>
<div class="paragraph">
<p>The core entities of the data repository are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Users</em>: individual users in the organisation, looking for data,
contributing to data collections or managing data.</p>
</li>
<li>
<p><em>Workspaces</em> (for projects, teams): entities in the system linked, representing a group of users,
to organise data collections and data access.</p>
</li>
<li>
<p><em>Collections</em>: entities in the system to group data files.
These are the minimal units of data for data access and data modification rules.</p>
</li>
<li>
<p><em>Files</em>: The smallest units of data that the system processes.
Files always belong to a single collection.
Files can be added, changed and deleted, but not in all collection states.
Changing a file creates a new version.
Access to a file is based on access to the collection the file belongs to.
Files can be organised in <em>Directories</em>, which we will leave out of most descriptions for brevity.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="docs/images/diagrams/Collections%20access%20model.png" alt="Diagram"></span></p>
</div>
<div class="paragraph">
<p>The diagram above sketches the relevant entities and actors.
The basic structure consists of users, workspaces, collections and files as represented in the system.
Collections are the basic units of data access management.
A collection is owned by a workspace.
The responsibility for a collection is organised via the owner workspace:
members of the owner workspace can be assigned as editors or managers of the collection.
This reflects the situation where in an organisation, a data collection belongs to a project or a research team.
This way the workspace represents the organisational unit that is responsible for a number of data collections
(e.g., a research team or project).
Data can be shared with other workspaces or individual users (for reading)
and ownership may be transferred to another workspace
(e.g., in the case the workspace is temporary, or when the organisation changes).</p>
</div>
<div class="paragraph">
<p>Fairspace provides a <em>data catalogue</em>, containing all the metadata,
which is visible for all users with catalogue access (<em>View public metadata</em>).
Users with metadata write access (<em>Add shared metadata</em>) can add metadata to the catalogue.
Preferably this is done by an automated process that ensures the consistency
of the metadata and uniqueness of metadata entities.
Metadata on collection and file level is protected by the access policy of the collections.</p>
</div>
<div class="paragraph">
<p><em>User administration</em> is organised in an external component ([Keycloak]),
but user permissions are stored in Fairspace.
A back end application is responsible for storing the data and metadata,
and for providing APIs for securely retrieving and adding data and metadata using standard data formats and protocols.
A user interface application provides an interactive file manager and (meta)data browser
and data entry forms based on the back end APIs.
Besides the data storage and data management, Fairspace offers <em>analysis environments</em> using <a href="https://jupyterhub.readthedocs.io/">Jupyter Hub</a>.
In Jupyter Hub, the data repository is accessible. Every user has a private working directory.
We do no assumptions on the structure of the data or on the permissions of the external file systems
that are connected to the data repository and referenced in the data catalogue.
The organisation structure may be replicated in the different systems in incompatible ways,
and the permissions may not be aligned.</p>
</div>
<div class="sect2">
<h3 id="_workflow_and_access_modes">Workflow and access modes</h3>
<div class="paragraph">
<p>During the lifetime of a collection, different rules may be applicable for data modification and data access.
In Fairspace, collections follow a workflow with the following statuses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Active</em>: for the phase of data collection, data production and data processing;</p>
</li>
<li>
<p><em>Archived</em>: for when the data set is complete and is available for reuse;</p>
</li>
<li>
<p><em>Closed</em>: for when the data set should not be available for reading, but still needs to be preserved;</p>
</li>
<li>
<p><em>Deleted</em>: for when the data set needs to be permanently made unavailable.
This status is irreversible. There is one exception to this rule – for the sake of data loss prevention, in special cases, administrators can still undelete a collection that was already deleted.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In these different statuses, different actions on the data are enabled or disabled. Also, visibility of the data and linked metadata depends partly on the collection status.
We also distinguish three access modes for reading and listing files in a collection (where listing also includes seeing the metadata):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Restricted</em>: only access to explicitly selected workspaces and users;</p>
</li>
<li>
<p><em>Metadata published</em>: the collection and its files are visible, metadata linked to them is visible for all users;</p>
</li>
<li>
<p><em>Data published</em>: the files in the collection are readable for all users.
This mode is irreversible. There is one exception to this rule – there might be a special situation, resulting from, e.g., a legal reason, when a collection has to be unpublished. This action is available to administrators, but it is highly discouraged, since the collection (meta)data may already be referenced in other systems.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The statuses and access modes, and the transitions between them
are shown in the following diagram.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="docs/images/diagrams/Dataset%20workflow%20and%20visibility%20modes.png" alt="Collection editing and publication workflow"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_roles_and_permissions">Roles and permissions</h3>
<div class="paragraph">
<p>We distinguish the following roles in the solution:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>User</em>: regular users can only view their own workspaces and collections.</p>
</li>
<li>
<p><em>View public metadata</em>: the user can view public metadata, workspaces, collections and files;</p>
</li>
<li>
<p><em>View public data</em>: the user can read public files;</p>
</li>
<li>
<p><em>Admin</em>: can create workspaces, assign roles and permissions;</p>
</li>
<li>
<p><em>Add shared metadata</em>: can add, modify and delete shared metadata entities.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most users should have the <em>View public data</em> role.
Only when the shared metadata may contain sensitive information that should
not be visible for some users, the public data and public metadata roles should be discarded for
those users.</p>
</div>
<div class="paragraph">
<p>Workspaces are used to organise collections in a hierarchy. On workspace level there are two access levels:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Manager</em>: can edit workspace details, manage workspace access and manage access to all collections that belong to the workspace;</p>
</li>
<li>
<p><em>Member</em>: can create a collection in the workspace.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Access to collections and files is managed on collection level. We distinguish the following access levels on collections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>List</em>: see collection, directory and file names and metadata properties/relations
(only applicable for collections shared via the <em>Metadata published</em> access mode);</p>
</li>
<li>
<p><em>Read</em>: read file contents;</p>
</li>
<li>
<p><em>Write</em>: add files, add new file versions, mark files as deleted;</p>
</li>
<li>
<p><em>Manage</em>: grant, revoke access to the collection, change collection status and modes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Access levels are hierarchical: the <em>Read</em> level includes the <em>List</em> level;
the <em>Edit</em> level includes <em>Read</em> level; the <em>Manage</em> level includes <em>Edit</em> and <em>Read</em> level access.
The user that creates the collection gets <em>Manage</em> access.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_model_and_view_configuration">Data model and view configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Fairspace uses an <a href="https://jena.apache.org/">Apache Jena</a> database to store system metadata
and the custom domain specific metadata.
The data models for these metadata are defined using the <a href="https://www.w3.org/TR/shacl/">Shapes Constraint Language (SHACL)</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The system metadata includes workspaces, collections, directories, files, file versions, users and access rights.
The system data model is defined in  <a href="projects/saturn/src/main/resources/system-vocabulary.ttl">system-vocabulary.ttl</a></p>
</li>
<li>
<p>The customisable data model includes the custom (shared)
metadata entities, custom controlled vocabulary types,
and custom properties of the system entities.
The default custom data model is defined in <a href="projects/saturn/vocabulary.ttl">vocabulary.ttl</a>.
This data model can be overriden by a data more suitable for your organisation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A schematic overview of the default data model in <a href="projects/saturn/vocabulary.ttl">vocabulary.ttl</a>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="docs/images/diagrams/CDR%20data%20model.png" alt="CDR data model"></span></p>
</div>
<div class="paragraph">
<p>The data model defines an entity-relationship model, specifying
the entity types that are relevant to describe your data assets,
the properties of the entities, and the relationships between entities.</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. Example data model</div>
<div class="content">
<div class="paragraph">
<p>In this example data model, the following custom entity types are defined:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>example:Gender</code> with property <em>Label</em>;</p>
</li>
<li>
<p><code>example:Species</code> with property <em>Label</em>;</p>
</li>
<li>
<p><code>example:Subject</code> with properties <em>Gender</em>, <em>Species</em>, <em>Age at last news</em> and <em>Files</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The system class <code>fs:File</code> is extended with the <em>Is about subject</em> property.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="turtle"><span class="kd">@prefix</span><span class="w"> </span><span class="nn">owl:</span><span class="w"> </span><span class="nl">&lt;http://www.w3.org/2002/07/owl#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">rdf:</span><span class="w"> </span><span class="nl">&lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">rdfs:</span><span class="w"> </span><span class="nl">&lt;http://www.w3.org/2000/01/rdf-schema#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">sh:</span><span class="w"> </span><span class="nl">&lt;http://www.w3.org/ns/shacl#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">xsd:</span><span class="w"> </span><span class="nl">&lt;http://www.w3.org/2001/XMLSchema#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">dash:</span><span class="w"> </span><span class="nl">&lt;http://datashapes.org/dash#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">fs:</span><span class="w"> </span><span class="nl">&lt;https://fairspace.nl/ontology#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">example:</span><span class="w"> </span><span class="nl">&lt;https://example.com/ontology#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">

</span><span class="nn">example:</span><span class="n">Gender</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">rdfs:</span><span class="n">Class,</span><span class="w"> </span><span class="nn">sh:</span><span class="n">NodeShape</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">closed</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">description</span><span class="w"> </span><span class="s">"The gender of the subject."</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">name</span><span class="w"> </span><span class="s">"Gender"</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">ignoredProperties</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nn">rdf:</span><span class="n">type</span><span class="w"> </span><span class="nn">owl:</span><span class="n">sameAs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">property
</span><span class="w">    </span><span class="p">[</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">name</span><span class="w"> </span><span class="s">"Label"</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">description</span><span class="w"> </span><span class="s">"Unique gender label."</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">datatype</span><span class="w"> </span><span class="nn">xsd:</span><span class="n">string</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">maxCount</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">dash:</span><span class="n">singleLine</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">fs:</span><span class="n">importantProperty</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">path</span><span class="w"> </span><span class="nn">rdfs:</span><span class="n">label
</span><span class="w">    </span><span class="p">]</span><span class="w"> </span><span class="p">.</span><span class="w">

</span><span class="nn">example:</span><span class="n">Species</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">rdfs:</span><span class="n">Class,</span><span class="w"> </span><span class="nn">sh:</span><span class="n">NodeShape</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">closed</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">description</span><span class="w"> </span><span class="s">"The species of the subject."</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">name</span><span class="w"> </span><span class="s">"Species"</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">ignoredProperties</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nn">rdf:</span><span class="n">type</span><span class="w"> </span><span class="nn">owl:</span><span class="n">sameAs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">property
</span><span class="w">    </span><span class="p">[</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">name</span><span class="w"> </span><span class="s">"Label"</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">description</span><span class="w"> </span><span class="s">"Unique species label."</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">datatype</span><span class="w"> </span><span class="nn">xsd:</span><span class="n">string</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">maxCount</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">dash:</span><span class="n">singleLine</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">fs:</span><span class="n">importantProperty</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">path</span><span class="w"> </span><span class="nn">rdfs:</span><span class="n">label
</span><span class="w">    </span><span class="p">]</span><span class="w"> </span><span class="p">.</span><span class="w">

</span><span class="nn">example:</span><span class="n">isOfGender</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">rdf:</span><span class="n">Property</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="nn">example:</span><span class="n">isOfSpecies</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">rdf:</span><span class="n">Property</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="nn">example:</span><span class="n">ageAtLastNews</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">rdf:</span><span class="n">Property</span><span class="w"> </span><span class="p">.</span><span class="w">

</span><span class="nn">example:</span><span class="n">Subject</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">rdfs:</span><span class="n">Class,</span><span class="w"> </span><span class="nn">sh:</span><span class="n">NodeShape</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">closed</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">description</span><span class="w"> </span><span class="s">"A subject of research."</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">name</span><span class="w"> </span><span class="s">"Subject"</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">ignoredProperties</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nn">rdf:</span><span class="n">type</span><span class="w"> </span><span class="nn">owl:</span><span class="n">sameAs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">
    </span><span class="nn">sh:</span><span class="n">property
</span><span class="w">    </span><span class="p">[</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">name</span><span class="w"> </span><span class="s">"Label"</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">description</span><span class="w"> </span><span class="s">"Unique subject label."</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">datatype</span><span class="w"> </span><span class="nn">xsd:</span><span class="n">string</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">maxCount</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">dash:</span><span class="n">singleLine</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">fs:</span><span class="n">importantProperty</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">path</span><span class="w"> </span><span class="nn">rdfs:</span><span class="n">label</span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">order</span><span class="w"> </span><span class="mi">0</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">name</span><span class="w"> </span><span class="s">"Gender"</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">description</span><span class="w"> </span><span class="s">"The gender of the subject."</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">maxCount</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">class</span><span class="w"> </span><span class="nn">example:</span><span class="n">Gender</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">path</span><span class="w"> </span><span class="nn">example:</span><span class="n">isOfGender
</span><span class="w">    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">name</span><span class="w"> </span><span class="s">"Species"</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">description</span><span class="w"> </span><span class="s">"The species of the subject."</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">maxCount</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">class</span><span class="w"> </span><span class="nn">example:</span><span class="n">Species</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">path</span><span class="w"> </span><span class="nn">example:</span><span class="n">isOfSpecies
</span><span class="w">    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">name</span><span class="w"> </span><span class="s">"Age at last news"</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">description</span><span class="w"> </span><span class="s">"The age at last news."</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">datatype</span><span class="w"> </span><span class="nn">xsd:</span><span class="n">integer</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">maxCount</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">path</span><span class="w"> </span><span class="nn">example:</span><span class="n">ageAtLastNews
</span><span class="w">    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">name</span><span class="w"> </span><span class="s">"Files"</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">description</span><span class="w"> </span><span class="s">"Linked files"</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">path</span><span class="w"> </span><span class="p">[</span><span class="nn">sh:</span><span class="n">inversePath</span><span class="w"> </span><span class="nn">example:</span><span class="n">aboutSubject</span><span class="p">];</span><span class="w">
    </span><span class="p">]</span><span class="w"> </span><span class="p">.</span><span class="w">

</span><span class="nn">example:</span><span class="n">aboutSubject</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">rdf:</span><span class="n">Property</span><span class="w"> </span><span class="p">.</span><span class="w">

</span><span class="c1"># Augmented system class shapes</span><span class="w">
</span><span class="nn">fs:</span><span class="n">File</span><span class="w"> </span><span class="nn">sh:</span><span class="n">property
</span><span class="w">    </span><span class="p">[</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">name</span><span class="w"> </span><span class="s">"Is about subject"</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">description</span><span class="w"> </span><span class="s">"Subjects that are featured in this collection."</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">class</span><span class="w"> </span><span class="nn">example:</span><span class="n">Subject</span><span class="w"> </span><span class="p">;</span><span class="w">
        </span><span class="nn">sh:</span><span class="n">path</span><span class="w"> </span><span class="nn">example:</span><span class="n">aboutSubject
</span><span class="w">    </span><span class="p">]</span><span class="w"> </span><span class="p">.</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>All entity types have a unique label, specified using the <code>rdfs:label</code> predicate.
The <em>Gender</em> and <em>Species</em> properties link the subject to an entity from
the respective controlled vocabularies.
The <em>Age at last news</em> property is a numerical (integer) value property.<br>
The <em>Files</em> property of the <em>Subject</em> entity type is an example of an inverse relation.
The link is defined on the file, but the link will be visible on the subject as well, because of this inverse relation.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The following guidelines should be followed when creating a custom data model.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Define a namespace for your custom entities and properties,
like <code>@prefix example: <a href="https://example.com/ontology#" class="bare">https://example.com/ontology#</a> .</code> in the example.</p>
</li>
<li>
<p>Each custom entity type must have types <code>rdfs:Class</code> and <code>sh:NodeShape</code>, the properties <code>sh:closed false</code> and
<code>sh:ignoredProperties ( rdf:type owl:sameAs )</code>,
and a valid value for <code>sh:name</code>.
The <code>sh:description</code> property is optional.</p>
</li>
<li>
<p>Controlled vocabulary or terminology types are modelled as entity types as well, having only the <em>Label</em> (<code>rdfs:label</code>) property, see <code>example:Gender</code> and <code>example:Species</code>.</p>
</li>
<li>
<p>Properties are specified using the <code>sh:property</code> property.</p>
<div class="ulist">
<ul>
<li>
<p>Every entity type must have a property <em>Label</em> (<code>sh:path rdfs:label</code>)
of data type <code>xsd:string</code>.
The label of an entity must be unique for that type.
The label property should be singleton and marked <code>fs:importantProperty true</code>. If there are multiple properties, the label should have <code>sh:order: 0</code>.</p>
</li>
<li>
<p>Properties must have a valid value for <code>sh:name</code>.
The <code>sh:description</code> property is optional.</p>
</li>
<li>
<p>A property must either have a <code>sh:datatype</code> property,
specifying one of <code>xsd:string</code>, <code>xsd:integer</code> or <code>xsd:date</code>,
   or a property <code>sh:class</code> specifying an entity type as the target of a relationship.</p>
</li>
<li>
<p>The predicate used for the property (the middle part of the RDF triple)
is specified with the <code>sh:path</code> property, e.g., <code>example:aboutSubject</code>
for the <em>Is about subject</em> relation.</p>
</li>
<li>
<p>If a relationship is bidirectional, the path of the inverse relation is specified using <code>sh:inversePath</code>, see the <em>Files</em> property on the <em>Subject</em> entity type.</p>
</li>
<li>
<p>A property can be marked <em>mandatory</em> by specifying <code>sh:minCount 1</code>.
A property can be marked <em>singleton</em> by specifying <code>sh:maxCount 1</code>.</p>
</li>
<li>
<p>A text property (with <code>sh:datatype xsd:string</code>) can be limited
to a single line text field using <code>dash:singleLine true</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_limitations">Limitations</h3>
<div class="paragraph">
<p>Although assigning multiple types to an entity is easy in RDF, Fairspace assumes entities to have a single type.</p>
</div>
<div class="paragraph">
<p>Inheritance is possible in SHACL, but not supported by Fairspace.
Instead of specifying an entity type as a subtype of another,
a single type can be specified with a <em>type</em> property,
indicating the sub type of the entity.</p>
</div>
<div class="paragraph">
<p>E.g., instead of defining entity types <em>DNASeqAssay</em> and <em>RNASeqAssay</em>
as sub types of <em>Assay</em>, a property type <em>assayType</em> can be defined on <em>Assay</em>,
using a controlled vocabulary type <em>AssayType</em> with the assay types as values.</p>
</div>
</div>
<div class="sect2">
<h3 id="_controlled_vocabularies">Controlled vocabularies</h3>
<div class="paragraph">
<p>For controlled vocabulary types, e.g., <em>Gender</em> and <em>Species</em> in the example, you should insert the allowed values in the database by uploading
a taxonomies file using the <a href="#Metadata upload API">[Metadata upload API]</a>.
An example taxonomy is in <a href="projects/saturn/taxonomies.ttl">taxonomies.ttl</a>.</p>
</div>
<div class="paragraph">
<p>It is preferred to use existing standard taxonomies and labels.
If that is not possible, please define your own namespaces for
your custom taxonomies.</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. Example taxonomy</div>
<div class="content">
<div class="paragraph">
<p>In this example we use existing standard ontologies for the <em>Gender</em> and <em>Species</em> controlled vocabulary types.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://hl7.org/fhir/R4/codesystem-administrative-gender.html">HL7 FHIR AdministrativeGender code system</a> for <em>Gender</em>.</p>
</li>
<li>
<p>The <a href="https://bioportal.bioontology.org/ontologies/NCBITAXON/">NCBI Organismal Classification</a> for <em>Species</em>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="turtle"><span class="kd">@prefix</span><span class="w"> </span><span class="nn">rdfs:</span><span class="w"> </span><span class="nl">&lt;http://www.w3.org/2000/01/rdf-schema#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">example:</span><span class="w"> </span><span class="nl">&lt;https://example.com/ontology#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">gender:</span><span class="w"> </span><span class="nl">&lt;http://hl7.org/fhir/administrative-gender#&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="kd">@prefix</span><span class="w"> </span><span class="nn">ncbitaxon:</span><span class="w"> </span><span class="nl">&lt;https://bioportal.bioontology.org/ontologies/NCBITAXON/&gt;</span><span class="w"> </span><span class="p">.</span><span class="w">

</span><span class="nn">gender:</span><span class="n">male</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">example:</span><span class="n">Gender</span><span class="w"> </span><span class="p">;</span><span class="w">
  </span><span class="nn">rdfs:</span><span class="n">label</span><span class="w"> </span><span class="s">"Male"</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="nn">gender:</span><span class="n">female</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">example:</span><span class="n">Gender</span><span class="w"> </span><span class="p">;</span><span class="w">
  </span><span class="nn">rdfs:</span><span class="n">label</span><span class="w"> </span><span class="s">"Female"</span><span class="w"> </span><span class="p">.</span><span class="w">

</span><span class="nn">ncbitaxon:</span><span class="mi">562</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">example:</span><span class="n">Species</span><span class="w"> </span><span class="p">;</span><span class="w">
  </span><span class="nn">rdfs:</span><span class="n">label</span><span class="w"> </span><span class="s">"Escherichia coli"</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="nn">ncbitaxon:</span><span class="mi">1423</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">example:</span><span class="n">Species</span><span class="w"> </span><span class="p">;</span><span class="w">
  </span><span class="nn">rdfs:</span><span class="n">label</span><span class="w"> </span><span class="s">"Bacillus subtilis"</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="nn">ncbitaxon:</span><span class="mi">4896</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">example:</span><span class="n">Species</span><span class="w"> </span><span class="p">;</span><span class="w">
  </span><span class="nn">rdfs:</span><span class="n">label</span><span class="w"> </span><span class="s">"Schizosaccharomyces pombe"</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="nn">ncbitaxon:</span><span class="mi">4932</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">example:</span><span class="n">Species</span><span class="w"> </span><span class="p">;</span><span class="w">
  </span><span class="nn">rdfs:</span><span class="n">label</span><span class="w"> </span><span class="s">"Saccharomyces cerevisiae"</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="nn">ncbitaxon:</span><span class="mi">6239</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">example:</span><span class="n">Species</span><span class="w"> </span><span class="p">;</span><span class="w">
  </span><span class="nn">rdfs:</span><span class="n">label</span><span class="w"> </span><span class="s">"Caenorhabditis elegans"</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="nn">ncbitaxon:</span><span class="mi">7227</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">example:</span><span class="n">Species</span><span class="w"> </span><span class="p">;</span><span class="w">
  </span><span class="nn">rdfs:</span><span class="n">label</span><span class="w"> </span><span class="s">"Drosophila melanogaster"</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="nn">ncbitaxon:</span><span class="mi">7955</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">example:</span><span class="n">Species</span><span class="w"> </span><span class="p">;</span><span class="w">
  </span><span class="nn">rdfs:</span><span class="n">label</span><span class="w"> </span><span class="s">"Zebrafish"</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="nn">ncbitaxon:</span><span class="mi">8355</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">example:</span><span class="n">Species</span><span class="w"> </span><span class="p">;</span><span class="w">
  </span><span class="nn">rdfs:</span><span class="n">label</span><span class="w"> </span><span class="s">"Xenopus laevis"</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="nn">ncbitaxon:</span><span class="mi">9606</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">example:</span><span class="n">Species</span><span class="w"> </span><span class="p">;</span><span class="w">
  </span><span class="nn">rdfs:</span><span class="n">label</span><span class="w"> </span><span class="s">"Homo sapiens"</span><span class="w"> </span><span class="p">.</span><span class="w">
</span><span class="nn">ncbitaxon:</span><span class="mi">10090</span><span class="w"> </span><span class="k">a</span><span class="w"> </span><span class="nn">example:</span><span class="n">Species</span><span class="w"> </span><span class="p">;</span><span class="w">
  </span><span class="nn">rdfs:</span><span class="n">label</span><span class="w"> </span><span class="s">"Mus musculus"</span><span class="w"> </span><span class="p">.</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation_and_configuration">Installation and configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_local_development">Local development</h3>
<div class="paragraph">
<p>Requires:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>yarn</p>
</li>
<li>
<p>docker</p>
</li>
<li>
<p>Java 15</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To run the development version, checkout this repository,
navigate to <code>projects/mercury</code> and run</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">yarn dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>If on MacOS, configure docker logging&#8230;&#8203;. TODO
As env variable, or in <code>.env</code> file: <code>DOCKER_LOGGING_DRIVER=json-file</code>.</p>
</div>
<div class="paragraph">
<p>This will start a Keycloak instance for authentication at port <code>5100</code>,
the backend application named Saturn at port <code>8080</code> and the
user interface at port <code>3000</code>.</p>
</div>
<div class="paragraph">
<p>At first run, you need to configure the service account in Keycloak.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Navigate to <a href="http://localhost:5100">http://localhost:5100</a></p>
</li>
<li>
<p>Login with credentials <code>keycloak</code>, <code>keycloak</code></p>
</li>
<li>
<p>Grant <code>realm-management</code> roles in the Fairspace realm: <code>view-realm</code>, <code>manage-realm</code>, <code>manage-authorization</code>, <code>manage-users</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now everything should be ready to start using Fairspace:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Navigate to <a href="http://localhost:3000">http://localhost:3000</a> to open the application.</p>
</li>
<li>
<p>Login with one of the following credentials:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Username</th>
<th class="tableblock halign-left valign-top">Password</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">organisation-admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fairspace123</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fairspace123</p></td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_kubernetes_and_helm">Kubernetes and helm</h3>
<div class="paragraph">
<p>You can deploy Fairspace on a Kubernetes cluster using <a href="https://helm.sh/">Helm</a>.
Helm charts for Fairspace are published to the public helm repository at
<a href="https://storage.googleapis.com/fairspace-helm" class="bare">https://storage.googleapis.com/fairspace-helm</a>.</p>
</div>
<div class="sect3">
<h4 id="_instructions_for_deploying_to_google_cloud">Instructions for deploying to Google Cloud</h4>
<div class="sect4">
<h5 id="_download_and_install_helm_and_gcloud">Download and install helm and gcloud</h5>
<div class="ulist">
<ul>
<li>
<p>Download <code>helm 2.14.3</code> from from <a href="https://github.com/helm/helm/releases/tag/v2.14.3" class="bare">https://github.com/helm/helm/releases/tag/v2.14.3</a></p>
</li>
<li>
<p>Extract the downloaded archive to <code>~/bin/helm</code> and check with:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">~/bin/helm/helm version</code></pre>
</div>
</div>
</li>
<li>
<p>Install <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">kubectl</a>.</p>
</li>
<li>
<p>Download and install the <a href="https://cloud.google.com/sdk/docs/install">Google Cloud SDK</a> (requires Python).</p>
</li>
<li>
<p>Obtain credentials for Kubernetes:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">  gcloud container clusters get-credentials &lt;cluster <span class="nb">id</span><span class="o">&gt;</span> <span class="nt">--zone</span> europe-west1-b</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use <code>fairspacecicluster</code> as cluster id for the CI environment.
Ensure that your Google account has access to the <code>fairspace-207108</code> GCP project
and log in using</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">  gcloud auth login</code></pre>
</div>
</div>
</li>
<li>
<p>Check if all tools are correctly installed:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c"># List available clusters</span>
gcloud container clusters list
<span class="c"># List Kubernetes namespaces</span>
kubectl get ns
<span class="c"># List helm releases (deployments)</span>
~/bin/helm/helm list</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_initialise_helm_and_add_fairspace_repository">Initialise helm and add fairspace repository</h5>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c"># Initialise helm</span>
~/bin/helm/helm init <span class="nt">--client-only</span> <span class="nt">--stable-repo-url</span> https://charts.helm.sh/stable
<span class="c"># Add the fairspace repo for reading</span>
~/bin/helm/helm repo add fairspace https://storage.googleapis.com/fairspace-helm
<span class="c"># (Optional) Add the fairspace repo via the GCS plugin for writing</span>
~/bin/helm/helm plugin <span class="nb">install </span>https://github.com/hayorov/helm-gcs.git <span class="nt">--version</span> 0.2.2
gcloud iam service-accounts keys create credentials.json <span class="nt">--iam-account</span> fairspace-207108@appspot.gserviceaccount.com
<span class="nb">export </span><span class="nv">GOOGLE_APPLICATION_CREDENTIALS</span><span class="o">=</span>/path/to/credentials.json
~/bin/helm/helm repo add fairspace-gcs gs://fairspace-helm</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_fetch_chart">Fetch chart</h5>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c"># Update repo</span>
~/bin/helm/helm repo update
<span class="c"># Fetch the fairspace chart</span>
~/bin/helm/helm fetch fairspace/fairspace <span class="nt">--version</span> 0.7.5</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_deploy_fairspace">Deploy Fairspace</h5>
<div class="paragraph">
<p>Create a new Kubernetes namespace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">kubectl create namespace fairspace-new</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a new deployment (called <em>release</em> in helm terminology) and
install the Fairspace chart:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">~/bin/helm/helm <span class="nb">install </span>fairspace/fairspace <span class="nt">--version</span> 0.7.5 <span class="nt">--name</span> fairspace-new <span class="nt">--namespace</span><span class="o">=</span>fairspace-new <span class="se">\</span>
<span class="nt">-f</span> /path/to/values.yaml <span class="nt">--set-file</span> saturn.vocabulary<span class="o">=</span>/path/to/vocabulary.ttl <span class="nt">--set-file</span> saturn.views<span class="o">=</span>/path/to/views.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can pass values files with <code>-f</code> and provide a file for a specified
value with <code>--set-file</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_update_an_existing_deployment">Update an existing deployment</h5>
<div class="paragraph">
<p>To update a deployment using a new chart:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">~/bin/helm/helm upgrade fairspace-new fairspace-0.7.5.tgz</code></pre>
</div>
</div>
<div class="paragraph">
<p>With <code>helm upgrade</code> you can also pass new values files with <code>-f</code>
and pass files with <code>--set-file</code> as for <code>helm install</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_clean_up_deployment">Clean up deployment</h5>
<div class="paragraph">
<p>To clean up an environment or completely reinstall an environment, you can use <code>helm del</code>.
:warning: Be careful, you may lose data!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">~/bin/helm/helm del <span class="nt">--purge</span> fairspace-test</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_design">Design</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_storage">Storage</h3>
<div class="paragraph">
<p>RDF database using <a href="https://jena.apache.org/">Apache Jena</a> for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>File metadata</p>
</li>
<li>
<p>Permissions</p>
</li>
<li>
<p>User metadata</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>File system data stored as blocks on the file system in append-only fashion.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_license">License</h2>
<div class="sectionbody">
<div class="paragraph">
<p>&#8230;&#8203;</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-02-01 15:43:13 UTC
</div>
</div>
</body>
</html>